<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <title th:text="|${problem.originOJ} ${problem.title}|">Problem</title>
    <link rel="stylesheet" href="../../static/plugin/semanticui/semantic.min.css"
          th:href="@{/plugin/semanticui/semantic.min.css}">
    <script src="../../static/js/jquery-3.4.1.min.js" th:src="@{/js/jquery-3.4.1.min.js}"></script>
    <script src="../../static/plugin/semanticui/semantic.min.js"
            th:src="@{/plugin/semanticui/semantic.min.js}"></script>
    <link rel="stylesheet" href="../../static/css/me.css" th:href="@{/css/me.css}">


    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [ ['$$$','$$$'],['$','$'] ], displayMath: [ ['$$$$$$','$$$$$$'] ]}
        });


    </script>


</head>
<body>
<!--导航栏-->
<div class="ui attached" th:replace="_fragments::nav(2)">
    <div class="ui fluid  container ">
        <div class="ui huge grid secondary pointing  stackable  menu padded">
            <a href="#" class="ui item menu toggle icon button m-right-top m-mobile-show">
                <i class="sidebar icon"></i>
            </a>
            <div class="ui header item m-item m-mobile-hide m-text-large m-padded-b-tiny m-text-thin m-opacity-mini">
                Online Judge
            </div>
            <a href="#" class="ui item m-item m-mobile-hide"><i class="small home icon"></i>Home</a>
            <a href="#" class="ui item m-item m-mobile-hide active blue"><i class="small th icon"></i>Problem</a>
            <a href="#" class="ui item m-item m-mobile-hide"><i class="small bell icon"></i>Contest</a>
            <a href="#" class="ui item m-item m-mobile-hide"><i class="small edit icon"></i>Status</a>
            <a href="#" class="ui item m-item m-mobile-hide"><i class="small trophy icon"></i>Rank</a>
            <a href="#" class="ui item m-item m-mobile-hide"><i class="small file alternate outline icon"></i>Blog</a>
            <a href="#" class="ui item m-item m-mobile-hide"><i class="small envelope icon"></i>Message</a>
            <a href="#" class="ui item m-item m-mobile-hide"><i class="small paper plane icon"></i>Tool</a>
            <div class="ui item m-item m-mobile-hide  right floated m-margin-r" style="height: 48px">
                <a href="#" class="m-margin-r m-black">Login</a>
                <a href="#" class="m-margin-r m-black">Register</a>
                <a href="#" class="m-margin-r-medium"><img src="../../static/img/35.jpg" class="ui avatar image"
                                                           style=""></a>
            </div>
        </div>
    </div>
</div>


<div class="m-margin-large m-container-huge">
    <div class="ui fluid container m-margin-top-large m-margin-large">
        <div class="ui stackable centered grid">


            <!--        题目-->
            <div class="twelve wide column">
                <div class="ui title">
                    <h1 class="ui header  text center aligned" th:text="${problem.title}">爱学习的Hang</h1>
                    <div class="ui fluid container text center aligned">
                        TimeLimit:<span th:text="${problem.timeLimit}"></span>MS MemoryLimit:<span
                            th:text="${problem.memoryLimit}"></span>B
                    </div>
                    <div class="ui fluid container text center aligned">
                        64-bit integer IO format: <span class="ui label" th:text="${problem.IOFormat}">%lld</span>
                    </div>

                </div>
                <!--题目描述-->
                <div class="ui segments">
                    <div class="ui secondary segment">
                        Problem Description
                    </div>
                    <div class="ui segment" th:utext="${description.description}">
                        总所周知，Hang是一个爱学习的人。

                        经过一次又一次的学习，Hang发现自己的学习效率呈一条类抛物线。

                        简单点说，就是从学习开始，学习精力单调不减，到一个临界值后，单调不增

                        现在Hang对今天要学习的知识点按顺序标出精力值，Hang希望能学习尽量多的知识点。

                        Hang可以选择一些知识点不看，但一定要按给出的顺序从左往右学，而且要保证

                        在临界值（或者说是最大值）之前，对于任意i

                        ,a[i]
                        <=a[j]。

                        在临界值（或者说是最大值）之后，对于任意i

                        ,a[i]>=a[j]。

                        为了方便大家AC（你确定不是因为你懒得写标程？）

                        第一个（或最后一个）学习知识点可以是最大值。也就是说，曲线可以只单调不减或只单调不增。
                    </div>
                </div>
                <!--样例-->
                <div class="ui segments">
                    <div class="ui secondary segment">
                        Input
                    </div>
                    <div class="ui segment" th:utext="${description.input}">
                        <div class="panel_content">
                            There are several test cases. Each test case consists of
                            <br>
                            <br>a line containing two integers between 1 and 100: n and k
                            <br>n lines, each with n numbers: the first line contains the number of blocks of cheese at
                            locations (0,0) (0,1) ... (0,n-1); the next line contains the number of blocks of cheese at
                            locations (1,0), (1,1), ... (1,n-1), and so on.
                            <br>The input ends with a pair of -1's.
                            <br>
                        </div>
                    </div>
                </div>

                <div class="ui segments">
                    <div class="ui secondary segment">
                        Output
                    </div>
                    <div class="ui segment" th:utext="${description.output}">
                        对于每组数据输出一个值，表示Hang最多能学习多少个知识点
                    </div>
                </div>


                <div class="m-margin-bottom-large" th:each="sample,stat:${description.sampleList}">
                    <div class="ui segments">
                        <div class="ui secondary segment" th:text="|SampleInput ${stat.count}|">
                            SampleInput
                        </div>
                        <div class="ui segment" th:utext="${sample.input}"
                             style="padding-top: 0;padding-bottom: 0"></div>
                    </div>
                    <div class="ui segments">
                        <div class="ui secondary segment" th:text="|SampleOutput ${stat.count}|">
                            SampleOutput
                        </div>
                        <div class="ui segment" th:utext="${sample.output}" style="padding-top: 0;padding-bottom: 0">
                            4
                        </div>
                    </div>
                </div>
                <div class="ui segments" th:if="${!#strings.isEmpty(description.hint)}">
                    <div class="ui secondary segment">
                        Hint
                    </div>
                    <div class="ui segment" th:utext="${description.hint}">
                        对于每组数据输出一个值，表示Hang最多能学习多少个知识点
                    </div>
                </div>

                <div class="ui segments" th:if="${!#strings.isEmpty(problem.source)}">
                    <div class="ui secondary segment">
                        Source
                    </div>
                    <div class="ui segment" th:utext="${problem.source}">
                        对于每组数据输出一个值，表示Hang最多能学习多少个知识点
                    </div>
                </div>

                <div class="ui segment">
                    <!--代码输入框（注意请务必设置高度，否则无法显示）-->

                    <!--                    <span style="font-weight: 800">Language: &ensp;</span>-->
                    <select class="ui language dropdown">
                        <option value="c_cpp" th:each="ace,stat:${aceLanguage}" th:value="${ace.value}"
                                th:text="${ace.key}"></option>
                        <!--/*-->
                        <option value="c_cpp">c++</option>
                        <option value="java">java</option>
                        <option value="python">python</option>
                        <option value="pascal">Pascal</option>
                        <option value="php">PHP</option>
                        <option value="csharp">C#</option>
                        <!--*/-->
                    </select>


                    <select class="ui theme search dropdown">
                        <option value="xcode">xcode</option>
                        <option value="clouds">clouds</option>
                        <option value="clouds_midnight">clouds_midnight</option>
                        <option value="cobalt">cobalt</option>
                        <option value="dawn">dawn</option>
                        <option value="idle_fingers">idle_fingers</option>
                        <option value="kr_theme">kr_theme</option>
                        <option value="merbivore">merbivore</option>
                        <option value="merbivore_soft">merbivore_soft</option>
                        <option value="mono_industrial">mono_industrial</option>
                        <option value="monokai">monokai</option>
                        <option value="nord_dark">nord_dark</option>
                        <option value="pastel_on_dark">pastel_on_dark</option>
                        <option value="solarized_dark">solarized_dark</option>
                        <option value="solarized_light">solarized_light</option>
                        <option value="katzenmilch">katzenmilch</option>
                        <option value="kuroir">kuroir</option>
                        <option value="tomorrow">tomorrow</option>
                        <option value="tomorrow_night">tomorrow_night</option>
                        <option value="tomorrow_night_blue">tomorrow_night_blue</option>
                        <option value="tomorrow_night_bright">tomorrow_night_bright</option>
                        <option value="tomorrow_night_eighties">tomorrow_night_eighties</option>
                        <option value="twilight">twilight</option>
                        <option value="vibrant_ink">vibrant_ink</option>
                    </select>

                    <div class="ui divider"></div>
                    <pre id="code" class="ace_editor" style="min-height:400px;"><textarea
                            class="ace_text-input"></textarea></pre>
                    <button class="ui basic button" id="codeSubmit">Submit</button>

                </div>

            </div>


            <!--右边的top-->
            <div class="four wide column">
                <div class="ui">
                    <a href="" target="_blank" th:href="${problem.url}"
                       th:text="|${problem.originOJ} ${problem.originProb}|">HDU 1103</a>
                </div>
                <div class="ui segment">
                    <div class="ui header">Statistics</div>
                    <div id="main" class="static-chart" style="height: 300px">
                            <div class="ui active loader"></div>
                    </div>
                </div>

                <div class="ui segment">
                    <div class="ui header">Tag</div>
                    <div class="ui divider"></div>


                    <button class="ui button label m-margin-top-small" th:each="tag:${tags}" th:text="${tag.tagName}">
                        困难
                    </button>
                    <!--/*-->
                    <a class="ui button label">简单</a>
                    <button class="ui button label m-margin-top-small">二分</button>
                    <button class="ui button label m-margin-top-small">线段树</button>
                    <button class="ui button label m-margin-top-small">模拟</button>
                    <button class="ui button label m-margin-top-small">暴力</button>
                    <button class="ui button label m-margin-top-small">思维</button>
                    <button class="ui button label m-margin-top-small">贪心</button>
                    <button class="ui button label m-margin-top-small">字符串</button>
                    <button class="ui button label m-margin-top-small">数据结构</button>
                    <button class="ui button label m-margin-top-small">逆元</button>
                    <!--*/-->
                </div>
                <div class="ui segment">
                    <div class="ui header">Submissions</div>
                    <div class="ui divider"></div>

                    <table class="ui very basic table center aligned">
                        <thead>
                        <tr>
                            <th>Result</th>
                            <th>Submit Time</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="sub:${latestSubmit}">
                            <td>
                                <a href="#" target="_blank" th:if="${sub.statusType==1}" th:href="@{/submission/{sid}(sid=${sub.sid})}" style="color: #21ba45" th:text="${sub.status}">Accept</a>
                                <a href="#" target="_blank" th:if="${sub.statusType!=1}" th:href="@{/submission/{sid}(sid=${sub.sid})}" style="color: red" th:text="${sub.status}">Accept</a>
                            </td>
                            <td th:text="${#dates.format(sub.subTime,'yyyy-MM-dd HH:mm:ss')}">2020-05-22 13:11</td>
                        </tr>
                        <tr th:if="${latestSubmit==null || latestSubmit.isEmpty()}">
                            <td colspan="2">No submission record</td>
                        </tr>
                        <!--/*-->
                        <tr>
                            <td><a href="#" style="color: #21ba45">Accept</a></td>
                            <td>2020-05-22 13:11</td>
                        </tr>
                        <tr>
                            <td><a href="#" style="color: #21ba45">Accept</a></td>
                            <td>2020-05-22 13:11</td>
                        </tr>
                        <tr>
                            <td><a href="#" style="color: #21ba45">Accept</a></td>
                            <td>2020-05-22 13:11</td>
                        </tr>
                        <tr>
                            <td><a href="#" style="color: #21ba45">Accept</a></td>
                            <td>2020-05-22 13:11</td>
                        </tr>
                        <tr>
                            <td><a href="#" style="color: #21ba45">Accept</a></td>
                            <td>2020-05-22 13:11</td>
                        </tr>
                        <!--*/-->
                        </tbody>
                    </table>

                </div>

            </div>

        </div>
    </div>

</div>


<!--模态框部分  提交代码-->

<div class="ui modal">
    <div class="header">Submit</div>

    <div class="content">
        <form class="ui form">
            <input type="hidden" name="originOJ" th:value="${problem.originOJ}">
            <input type="hidden" name="pid" th:value="${problem.pid}">
            <div class="field">
                <select name="language" class="ui submit-language dropdown">
                    <option  value="c_cpp" th:each="lang,stat:${ojLanguage}" th:value="${lang.key}"
                            th:text="${lang.value}"></option>
                    <!--/*-->
                    <option value="c_cpp">c++</option>
                    <option value="java">java</option>
                    <option value="python">python</option>
                    <option value="pascal">Pascal</option>
                    <option value="php">PHP</option>
                    <option value="csharp">C#</option>
                    <!--*/-->
                </select>
            </div>
            <div class="field">
                <label>Code</label>
                <textarea name="source" rows="20"></textarea>
            </div>
        </form>


    </div>
    <div class="actions">
        <button class="ui negative button">cancel</button>
        <button class="ui positive button">Submit</button>
    </div>
</div>



<br><br><br><br><br><br><br><br><br><br>
<footer th:replace="_fragments::footer"></footer>

<script th:replace="_fragments::scriptFragment">
    $('.menu.toggle').click(function () {
        $('.m-item').toggleClass('m-mobile-hide');
    });
</script>

<script src="../../static/js/echarts.min.js" th:src="@{/js/echarts.min.js}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.6/ext-language_tools.js" type="text/javascript"
        charset="utf-8"></script>



<script>
    $('.language.ui.dropdown')
        .dropdown({
            // 当选择相应 oj后，用ajax发送请求
            onChange: function (value, text, $selectedItem) {
                editor.session.setMode("ace/mode/" + value);
            }
        });

    $('.theme.ui.dropdown')
        .dropdown({
            // 当选择相应 oj后，用ajax发送请求
            onChange: function (value, text, $selectedItem) {
                editor.setTheme("ace/theme/" + value);
            }
        });

    $(function () {

        $.get('[[@{/submission/statistic/}]]'+$('[name="pid"]').val()+'?time=' + new Date().getTime(),
            {},function (data) {
            console.log(data);
                var myChart = echarts.init(document.getElementById('main'));
                var legendArr=['AC','PE','WA','TLE','MLE','OLE','RE','CE','UE','Running & Judging','Pending'];

                for (let i = 0; i < data.data.length; i++) {
                    // console.log(data.data[i]);
                   data.data[i].name=legendArr[i];
                }
                console.log(legendArr);


                var option = {
                    legend: {
                        top: "0%",
                        data: legendArr,
                        textStyle: {
                            color: "rgba(0,0,0,.5)",
                            fontSize: "12"
                        }
                    },
                    tooltip: {
                        trigger: 'item',
                        formatter: "{a} <br/>{b} : {c} ({d}%)"
                    },
                    series: [{
                        name: 'submit detail',
                        type: 'pie',
                        radius: '65%',
                        center: ['50%', '60%'],
                        clockwise: false,
                        data: [{
                            value: 45,
                            name: 'Accepted'
                        }, {
                            value: 25,
                            name: 'Wrong Answer'
                        }, {
                            value: 15,
                            name: 'Time Limit Exceeded'
                        }, {
                            value: 8,
                            name: 'Compile Error'
                        }, {
                            value: 7,
                            name: 'Memory Limit Exceeded'
                        }, {
                            value: 7,
                            name: 'System Error'
                        }, {
                            value: 7,
                            name: 'Pending & Judging'
                        }, {
                            value: 7,
                            name: 'Runtime Error'
                        }],
                        label: {
                          show:false
                        },
                        labelLine: {
                            normal: {
                                show: false
                            }
                        },
                        itemStyle: {
                            normal: {
                                borderWidth: 4,
                                borderColor: '#ffffff',
                            },
                            emphasis: {
                                borderWidth: 0,
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }],
                    color: [
                        '#21ba45',
                        '#e03997',
                        '#db2828',
                        '#f2711c',
                        '#2185d0',
                        '#00b5ad',
                        '#a333c8',
                        '#fbbd08',
                        '#1b1c1d',
                        '#767676',
                        '#e0e1e2'
                    ],
                    backgroundColor: '#fff'
                };

                option.series[0].data=data.data;
                myChart.setOption(option);
                window.addEventListener("resize", function () {
                    myChart.resize();
                });

        });



    });


    //初始化对象
    editor = ace.edit("code");

    //设置风格和语言（更多风格和语言，请到github上相应目录查看）
    theme = "xcode";
    language = "c_cpp";
    editor.setTheme("ace/theme/" + theme);
    editor.session.setMode("ace/mode/" + language);

    //字体大小
    editor.setFontSize(18);

    //设置只读（true时只读，用于展示代码）
    editor.setReadOnly(false);

    //自动换行,设置为off关闭
    editor.setOption("wrap", "free");

    //启用提示菜单
    ace.require("ace/ext/language_tools");
    editor.setOptions({
        enableBasicAutocompletion: true,
        enableSnippets: true,
        enableLiveAutocompletion: true
    });

</script>

<!--提交代码-->
<script>



    $("#codeSubmit").click(function () {
        // 显示模态框
        var code = editor.getValue();
        $('[name="source"]').val(code);

        $('.ui.modal').modal({
            onApprove: function () {
                console.log("submit");
                if([[${session.user!=null}]]==false){
                    alert('请先登录');
                    return;
                }
                if($('[name="source"]').val().replace(/\s+/g,"").length==0){
                    alert('代码不能为空');
                    return;
                }
                $.post('[[@{/submission/problem/}]]'+$('[name="pid"]').val(),{
                    'sourceCode':$('[name="source"]').val(),
                    'language':$('[name="language"]').val(),
                    'originOJ':$('[name="originOJ"]').val()
                },function (data) {
                    if(data.flag==true){
                        // window.open("[[@{/status/}]]"+data.sid);
                        window.open("[[@{/status/}]]");
                    }else{
                        alert(data.flag)
                    }
                })
            }
        }).modal('show')
        ;

    })
</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>